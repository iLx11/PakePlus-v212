import{Ct as e,Ft as t,Nt as n,Q as r,Qt as i,Wt as a,_t as o,ct as s,in as c,mt as l,nn as u,ot as d,st as f,t as p,tt as m,vt as h,wt as g,xt as _,zt as v}from"./index-CxDn-bDx.js";var y={class:`advanced-key-config`},b={class:`config-header`},x={class:`config-content`},S={class:`config-section main-key-select`},C={class:`key-selection`},w=[`onClick`],T=p(g({__name:`RSConfigComp`,setup(p){let g=r(),T=d(),E=f(),D=i(E.restoreData);n(()=>{T.setAllKeysPressed(!1),O()});let O=()=>{E.isRestoreData&&(console.info(`restore --------`),console.info(E.restoreData),N.value.forEach((e,t)=>{e.key=E.advanceKeyData.configuredDataArr[D.value].key[t],e.col=E.advanceKeyData.configuredDataArr[D.value].col[t],e.row=E.advanceKeyData.configuredDataArr[D.value].row[t],behaviorMode.value=[...E.advanceKeyData.configuredDataArr[D.value].config],T.keyboardLayout[e.row][e.col].isSelect=!0}),N.value[0].isSelected=!0,E.advanceKeyData.configuredDataArr[D.value].col.forEach((e,t)=>{E.advanceKeyData.advanceKeyDataArr[E.advanceKeyData.configuredDataArr[D.value].row[t]][e].type=``}))};a(()=>E.keyClickHandleData.item.isSelect,(e,t)=>{e?j():M()},{deep:!0});let k=o(()=>N.value.some(e=>e.isSelected)),A=o(()=>N.value.findIndex(e=>e.isSelected)||0),j=()=>{if(N.value.some((e,t)=>e.row===E.keyClickHandleData.row&&e.col===E.keyClickHandleData.col)||E.advanceKeyData.advanceKeyDataArr[E.keyClickHandleData.row][E.keyClickHandleData.col].type!==``){E.popMes(`warning`,`该按键已被选择`);return}if(!k.value){E.popMes(`warning`,`请先选择按键`),E.keyClickHandleData.item.isSelect=!1;return}N.value.forEach((e,t)=>{N.value[t].key&&t!==A.value&&(T.keyboardLayout[e.row][e.col].isSelect=!0)}),N.value[A.value].key=E.keyClickHandleData.item.name,N.value[A.value].row=E.keyClickHandleData.row,N.value[A.value].col=E.keyClickHandleData.col},M=()=>{k.value&&N.value.forEach((e,t)=>{e.row===E.keyClickHandleData.row&&e.col===E.keyClickHandleData.col&&(N.value[A.value].key=``,N.value[A.value].row=0,N.value[A.value].col=0,N.value.forEach((e,t)=>{N.value[t].key&&t!==A.value&&(T.keyboardLayout[e.row][e.col].isSelect=!0)}))})},N=i([{label:`按键 1`,key:``,isSelected:!1,row:0,col:0},{label:`按键 2`,key:``,isSelected:!1,row:0,col:0}]),P=e=>{N.value.forEach((t,n)=>{t.isSelected=n===e}),N.value[e]&&N.value[e].key&&(T.keyboardLayout[N.value[e].row][N.value[e].col].isSelect=!0)},F=()=>{g.backToADConfig(),L()},I=()=>{g.backToADConfig(),L()},L=()=>{E.isRestoreData&&(E.isRestoreData=!1,E.advanceKeyData.configuredDataArr[D.value].col.forEach((e,t)=>{let n=E.advanceKeyData.configuredDataArr[D.value].row[t];E.advanceKeyData.advanceKeyDataArr[n][e].type=E.advanceKeyData.configuredDataArr[D.value].type}))},R=async()=>{if(!N.value.every(e=>e.key)){E.popMes(`warning`,`还有按键未选择`);return}N.value.forEach(e=>{E.advanceKeyData.advanceKeyDataArr[e.row][e.col].type=`rs`,E.advanceKeyData.advanceKeyDataArr[e.row][e.col].key.push(e.key)});let e={type:`rs`,key:[...N.value.map(e=>e.key)],col:[...N.value.map(e=>e.col)],row:[...N.value.map(e=>e.row)],config:[]};E.isRestoreData?(E.isRestoreData=!1,E.advanceKeyData.configuredDataArr.splice(D.value,1,e)):E.advanceKeyData.configuredDataArr.push(e),console.log(E.advanceKeyData.configuredDataArr),await m(),g.backToADConfig()};return(n,r)=>(t(),_(`div`,y,[h(`div`,b,[h(`button`,{class:`back-btn`,onClick:F},[e(s,{"icon-class":`advance_func-arrow_left`})]),r[0]||=h(`div`,{class:`title-group`},[h(`h2`,null,`迅洁（RS）`),h(`p`,{class:`description`},`同时按下两个按键时，触发按下键更深的那个按键`)],-1),h(`div`,{class:`config-actions`},[h(`div`,{class:`advance-cancel-btn`,onClick:I},` 取消 `),h(`div`,{class:`confirm-btn`,onClick:R},` 确认 `)])]),h(`div`,x,[h(`div`,S,[r[1]||=h(`div`,{class:`config-title`},[h(`h3`,null,`1.选择按键`),h(`p`,{class:`section-desc`},`从上方预览图中选择按键`)],-1),h(`div`,C,[(t(!0),_(l,null,v(N.value,(e,n)=>(t(),_(`div`,{class:u([`key-box`,{selected:e.isSelected,"is-config":e.key&&!e.isSelected}]),key:n,onClick:e=>P(n)},c(e?.key||e?.label),11,w))),128))])])])]))}}),[[`__scopeId`,`data-v-d070e79e`]]);export{T as default};